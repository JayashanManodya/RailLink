<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RailLink - Register</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Custom styles based on the new design system */
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #030304; /* Deep black background */
            color: #FFFFFF; /* White text */
            min-height: 100vh;
        }
        .hero-section {
            background-image: url('https://www.teardrop-hotels.com/wp-content/uploads/2025/03/1920x600.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            position: relative;
            transform: translateZ(0);
            -webkit-transform: translateZ(0);
        }
        .hero-overlay {
            /* Dark overlay using design system color */
            background-color: rgba(3, 3, 4, 0.8);
        }
        .register-card {
            background-color: rgba(24, 24, 29, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(189, 235, 41, 0.2);
        }
        .form-input {
            background-color: rgba(24, 24, 29, 0.8);
            border: 2px solid #848484;
            color: #FFFFFF;
            transition: all 0.3s ease;
        }
        .form-input:focus {
            border-color: #BDEB29;
            box-shadow: 0 0 0 3px rgba(189, 235, 41, 0.1);
            outline: none;
        }
        .form-input::placeholder {
            color: #848484;
        }
        .form-select {
            background-color: rgba(24, 24, 29, 0.8);
            border: 2px solid #848484;
            color: #FFFFFF;
            transition: all 0.3s ease;
        }
        .form-select:focus {
            border-color: #BDEB29;
            box-shadow: 0 0 0 3px rgba(189, 235, 41, 0.1);
            outline: none;
        }
        .btn-primary {
            background-color: #BDEB29;
            color: #030304;
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            background-color: #8CA43F;
            transform: translateY(-2px);
        }
        .btn-secondary {
            background-color: transparent;
            border: 2px solid #BDEB29;
            color: #BDEB29;
            transition: all 0.3s ease;
        }
        .btn-secondary:hover {
            background-color: #BDEB29;
            color: #030304;
        }
        .alert-error {
            background-color: rgba(220, 53, 69, 0.1);
            border: 1px solid #dc3545;
            color: #dc3545;
        }
        .alert-success {
            background-color: rgba(40, 167, 69, 0.1);
            border: 1px solid #28a745;
            color: #28a745;
        }
        .password-strength {
            height: 4px;
            background-color: #848484;
            border-radius: 2px;
            margin-top: 4px;
            transition: all 0.3s ease;
        }
        .password-strength.weak { background-color: #dc3545; width: 25%; }
        .password-strength.fair { background-color: #ffc107; width: 50%; }
        .password-strength.good { background-color: #28a745; width: 75%; }
        .password-strength.strong { background-color: #BDEB29; width: 100%; }
    </style>
</head>
<body class="text-white">
    
    <section class="hero-section min-h-screen flex items-center justify-center">
        <div class="hero-overlay absolute inset-0"></div>
        
        
        <header class="fixed top-0 left-0 w-full z-40 backdrop-blur-sm" style="background-color: rgba(24, 24, 29, 0.9);">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex justify-between items-center py-4">
                
                <a href="/" class="flex items-center space-x-2 text-xl font-bold text-white">
                    <i data-lucide="train-front" class="h-6 w-6" style="color: #BDEB29;"></i>
                    <span>RailLink</span>
                </a>
                
                
                <nav class="hidden md:flex space-x-6 text-white text-sm font-medium">
                    <a href="/" class="hover:transition duration-150" style="color: #FFFFFF;" onmouseover="this.style.color='#BDEB29'" onmouseout="this.style.color='#FFFFFF'">Home</a>
                    <a href="/dashboard" class="hover:transition duration-150" style="color: #FFFFFF;" onmouseover="this.style.color='#BDEB29'" onmouseout="this.style.color='#FFFFFF'">Dashboard</a>
                    <a href="/search-trains" class="hover:transition duration-150" style="color: #FFFFFF;" onmouseover="this.style.color='#BDEB29'" onmouseout="this.style.color='#FFFFFF'">Search Trains</a>
                    <a href="/help" class="hover:transition duration-150" style="color: #FFFFFF;" onmouseover="this.style.color='#BDEB29'" onmouseout="this.style.color='#FFFFFF'">Help</a>
                </nav>

                
                <div class="flex items-center space-x-4">
                    <a href="/login" class="text-white text-sm transition duration-150 hidden sm:block" style="color: #FFFFFF;" onmouseover="this.style.color='#BDEB29'" onmouseout="this.style.color='#FFFFFF'">Sign In</a>
                    <a href="/register" class="text-white text-sm font-semibold py-2 px-4 rounded-lg shadow-md transition duration-150 hidden sm:block" style="background-color: #BDEB29; color: #030304;" onmouseover="this.style.backgroundColor='#8CA43F'" onmouseout="this.style.backgroundColor='#BDEB29'">Sign Up</a>
                </div>
            </div>
        </header>

        
        <div class="max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10 w-full pt-20">
            <div class="register-card p-6 rounded-2xl shadow-2xl">
                
                <div class="text-center mb-6">
                    <div class="flex justify-center mb-3">
                        <div class="p-2 rounded-full" style="background-color: rgba(189, 235, 41, 0.1);">
                            <i data-lucide="user-plus" class="h-6 w-6" style="color: #BDEB29;"></i>
                        </div>
                    </div>
                    <h1 class="text-2xl font-bold mb-1" style="color: #FFFFFF;">Create Account</h1>
                    <p class="text-base" style="color: #848484;">Join RailLink and start your journey</p>
                </div>

                
                <div id="alert" class="alert-error p-4 rounded-lg mb-6 flex items-center" style="display: none;">
                    <i data-lucide="alert-circle" class="h-5 w-5 mr-3"></i>
                    <span id="alert-message"></span>
                </div>
                
                
                <form id="registerForm" class="space-y-4">
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        
                        <div>
                            <label for="username" class="block text-sm font-medium mb-2" style="color: #FFFFFF;">
                                <i data-lucide="user" class="inline h-4 w-4 mr-2" style="color: #BDEB29;"></i>
                                Username
                            </label>
                            <input type="text" id="username" name="username" class="form-input w-full px-4 py-3 rounded-lg" placeholder="Choose a username" required>
                        </div>
                        
                        
                        <div>
                            <label for="email" class="block text-sm font-medium mb-2" style="color: #FFFFFF;">
                                <i data-lucide="mail" class="inline h-4 w-4 mr-2" style="color: #BDEB29;"></i>
                                Email Address
                            </label>
                            <input type="email" id="email" name="email" class="form-input w-full px-4 py-3 rounded-lg" placeholder="Enter your email" required>
                        </div>
                    </div>
                    
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        
                        <div>
                            <label for="password" class="block text-sm font-medium mb-2" style="color: #FFFFFF;">
                                <i data-lucide="lock" class="inline h-4 w-4 mr-2" style="color: #BDEB29;"></i>
                                Password
                            </label>
                            <input type="password" id="password" name="password" class="form-input w-full px-4 py-3 rounded-lg" placeholder="Create a strong password" required>
                            <div class="password-strength" id="passwordStrength"></div>
                            <p class="text-xs mt-1" style="color: #848484;">Password must be at least 8 characters long</p>
                        </div>
                        
                        
                        <div>
                            <label for="confirmPassword" class="block text-sm font-medium mb-2" style="color: #FFFFFF;">
                                <i data-lucide="lock" class="inline h-4 w-4 mr-2" style="color: #BDEB29;"></i>
                                Confirm Password
                            </label>
                            <input type="password" id="confirmPassword" name="confirmPassword" class="form-input w-full px-4 py-3 rounded-lg" placeholder="Confirm your password" required>
                            <div id="passwordMatch" class="text-xs mt-1" style="color: #848484;"></div>
                        </div>
                    </div>
                    
                    
                    <div class="flex items-start">
                        <input type="checkbox" id="terms" class="mr-3 mt-1" style="accent-color: #BDEB29;" required>
                        <label for="terms" class="text-sm" style="color: #848484;">
                            I agree to the 
                            <a href="#" class="transition duration-150" style="color: #BDEB29;" onmouseover="this.style.color='#8CA43F'" onmouseout="this.style.color='#BDEB29'">Terms of Service</a>
                            and 
                            <a href="#" class="transition duration-150" style="color: #BDEB29;" onmouseover="this.style.color='#8CA43F'" onmouseout="this.style.color='#BDEB29'">Privacy Policy</a>
                        </label>
                    </div>
                    
                    
                    <button type="submit" class="btn-primary w-full py-3 rounded-lg font-semibold text-lg shadow-lg">
                        <i data-lucide="user-plus" class="inline h-5 w-5 mr-2"></i>
                        Create Account
                    </button>
                </form>
                
                
                <div class="flex items-center my-4">
                    <div class="flex-1 border-t" style="border-color: #848484;"></div>
                    <span class="px-4 text-sm" style="color: #848484;">or</span>
                    <div class="flex-1 border-t" style="border-color: #848484;"></div>
                </div>
                
                
                <div class="text-center">
                    <p class="text-sm" style="color: #848484;">
                        Already have an account? 
                        <a href="/login" class="font-semibold transition duration-150" style="color: #BDEB29;" onmouseover="this.style.color='#8CA43F'" onmouseout="this.style.color='#BDEB29'">
                            Sign in here
                        </a>
                    </p>
                </div>
            </div>
        </div>
    </section>

    <script>
        // Initialize Lucide Icons
        lucide.createIcons();

        // Password strength checker
        function checkPasswordStrength(password) {
            const strengthBar = document.getElementById('passwordStrength');
            let strength = 0;
            
            if (password.length >= 8) strength++;
            if (/[a-z]/.test(password)) strength++;
            if (/[A-Z]/.test(password)) strength++;
            if (/[0-9]/.test(password)) strength++;
            if (/[^A-Za-z0-9]/.test(password)) strength++;
            
            strengthBar.className = 'password-strength';
            if (strength <= 2) {
                strengthBar.classList.add('weak');
            } else if (strength === 3) {
                strengthBar.classList.add('fair');
            } else if (strength === 4) {
                strengthBar.classList.add('good');
            } else {
                strengthBar.classList.add('strong');
            }
        }

        // Form validation and interactions
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('registerForm');
            const inputs = document.querySelectorAll('.form-input, .form-select');
            const passwordInput = document.getElementById('password');
            const alertDiv = document.getElementById('alert');
            const alertMessage = document.getElementById('alert-message');
            
            // Password strength checking
            passwordInput.addEventListener('input', function() {
                checkPasswordStrength(this.value);
            });
            
            // Password confirmation checking
            const confirmPasswordInput = document.getElementById('confirmPassword');
            const passwordMatchDiv = document.getElementById('passwordMatch');
            
            function checkPasswordMatch() {
                const password = passwordInput.value;
                const confirmPassword = confirmPasswordInput.value;
                
                if (confirmPassword.length > 0) {
                    if (password === confirmPassword) {
                        passwordMatchDiv.textContent = '✓ Passwords match';
                        passwordMatchDiv.style.color = '#BDEB29';
                        confirmPasswordInput.style.borderColor = '#BDEB29';
                    } else {
                        passwordMatchDiv.textContent = '✗ Passwords do not match';
                        passwordMatchDiv.style.color = '#ff6b6b';
                        confirmPasswordInput.style.borderColor = '#ff6b6b';
                    }
                } else {
                    passwordMatchDiv.textContent = '';
                    confirmPasswordInput.style.borderColor = '#848484';
                }
            }
            
            confirmPasswordInput.addEventListener('input', checkPasswordMatch);
            passwordInput.addEventListener('input', checkPasswordMatch);
            
            // Add focus effects
            inputs.forEach(input => {
                input.addEventListener('focus', function() {
                    this.parentElement.classList.add('focused');
                });
                
                input.addEventListener('blur', function() {
                    this.parentElement.classList.remove('focused');
                });
            });

            // Form submission
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const submitBtn = this.querySelector('button[type="submit"]');
                const originalText = submitBtn.innerHTML;
                
                // Validate password match
                const password = document.getElementById('password').value;
                const confirmPassword = document.getElementById('confirmPassword').value;
                
                if (password !== confirmPassword) {
                    alertDiv.className = 'alert-error p-4 rounded-lg mb-6 flex items-center';
                    alertMessage.textContent = 'Passwords do not match. Please check and try again.';
                    alertDiv.style.display = 'block';
                    return;
                }
                
                // Show loading state
                submitBtn.innerHTML = '<i data-lucide="loader-2" class="inline h-5 w-5 mr-2 animate-spin"></i>Creating Account...';
                submitBtn.disabled = true;
                alertDiv.style.display = 'none';
                
                // Re-initialize icons for the new content
                setTimeout(() => lucide.createIcons(), 100);
                
                // Collect form data
                const formData = {
                    username: document.getElementById('username').value,
                    email: document.getElementById('email').value,
                    password: document.getElementById('password').value,
                    role: 'PASSENGER' // Default role for all new registrations
                };
                
                // Simulate API call (replace with actual endpoint)
                fetch('/register', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(formData)
                })
                .then(response => response.json())
                .then(data => {
                    if (data.message) {
                        alertDiv.className = 'alert-success p-4 rounded-lg mb-6 flex items-center';
                        alertMessage.textContent = data.message;
                        alertDiv.style.display = 'block';
                        
                        setTimeout(() => {
                            window.location.href = '/login';
                        }, 2000);
                    } else {
                        throw new Error(data.error || 'Registration failed');
                    }
                })
                .catch(error => {
                    alertDiv.className = 'alert-error p-4 rounded-lg mb-6 flex items-center';
                    alertMessage.textContent = error.message || 'Registration failed. Please try again.';
                    alertDiv.style.display = 'block';
                    
                    // Reset button
                    submitBtn.innerHTML = originalText;
                    submitBtn.disabled = false;
                    lucide.createIcons();
                });
            });
        });
    </script>
</body>
</html>